















# API文档

[TOC]

**返回类型**

```json
"Result" : {
    "success": "boolean",
    "errorMsg": "string",
    "data" : "object",
    "total": "int"
}
```

**请求类型和返回类型传递**

对于 POST请求, 均使用 JSON 格式进行转换

**额外功能特别说明**

> 隐私保护：后端处理
>
> 限制复制/粘贴：前端处理
>
> 预览资料: 前端处理
>
> 生成标签: 数据库直接脚本插入可以选择的所有标签

## 模块一【5 ==唐皓涵==】

### 注册

**基本信息**

> 请求路径：`/user/reg`
>
> 请求方式：POST
>
> 接口描述：注册新用户
>
> 说明：登陆时第一栏可以输入学工号或者邮箱，后端两者判断其一

**请求样例**

一个没有 id 的 `User` 类型

| 参数说明   | 说明           | 类型   | 是否必须 |      备注            |
| ---------- | -------------- | ------ | -------- | ---------------- |
| username   | 账号（学工号） | string | 是       |                  |
| password   | 密码           | string | 是       |  |
| ConfirmPassword | 确认密码 | String | 是 | 跟密码一致 |
| name       | 姓名           | string | 否       | 否，则账号做名字 |
| mail       | 邮箱           | string | 是       | 用于邮箱验证     |
| birthday   | 生日           | date   | 否       | 默认随机2000-1-1 |
| identity   | 注册身份       | int    | 是       | 见用户身份规范   |
| verifyCode | 输入的验证码   | int    | 是       | 后端进行判断     |

**响应样例**

返回创建的 `User` 类

### 邮箱验证

**基本信息**

> 请求路径：`/user/verify`
>
> 请求方式：GET
>
> 接口描述：获取并发送邮箱验证码
>
> 说明：无

**请求样例**

| 参数说明 | 说明 | 类型   | 是否必须 | 备注                           |
| -------- | ---- | ------ | -------- | ------------------------------ |
| mail     | 邮箱 | string | 是       | 用于和存在后端的键值对进行查询 |

**响应样例**

返回创建的 `String` 类型

### 登录

**基本信息**

> 请求路径：`/user/login`
>
> 请求方式：POST
>
> 接口描述：登录并获取登录信息
>
> 说明：无

**请求样例**

| 参数说明 | 说明        | 类型   | 是否必须 | 备注               |
| -------- | ----------- | ------ | -------- | ------------------ |
| mail     | 邮箱        | string | 否       | 和 username 二选一 |
| username | 学工号/账号 | string | 否       | 和 mail 二选一     |
| password | 密码        | string | 是       |                    |

**响应样例**

不含对象,仅含状态码即可

### 修改资料/密码

**基本信息**

> 请求路径：`/user/modify`
>
> 请求方式：POST
>
> 接口描述：修改资料/密码
>
> 说明：邮箱验证

**请求样例**

一个完整的 `User` 类

**响应样例**

返回最新的 `User` 类

### 获取用户信息

**基本信息**

> 请求路径：`user/info`
>
> 请求方式：GET
>
> 接口描述：获取用户信息
>
> 说明：

**请求样例**

| 参数说明 | 说明   | 类型 | 是否必须 | 备注 |
| -------- | ------ | ---- | -------- | ---- |
| user_id  | 用户id | int  | 是       |      |

**响应样例**

返回 `User` 类型

## 模块二【21 ==庄耿雄==】

### 创建课程

**基本信息**

> 请求路径：`/course/create`
>
> 请求方式：POST
>
> 接口描述：创建课程
>
> 说明：仅有教师可以创建课程

**请求样例**

一个没有 id 的课程类型 `course`

| 参数说明   | 说明     | 类型   | 是否必须 | 备注                       |
| ---------- | -------- | ------ | -------- | -------------------------- |
| name       | 课程名   | string | 是       |                            |
| creator_id | 创建者   | int    | 是       |                            |
| syllabus   | 课程大纲 | string | 否       |                            |
| assMethod  | 考核方式 | string | 是       |                            |
| score      | 学分     | float  | 是       | 可以为浮点数, 仅为 .5 类型 |
| time       | 学时     | int    | 是       |                            |

**响应样例**

返回完整的 `course` 类型

### 创建班级

**基本信息**

> 请求路径：`/class/create`
>
> 请求方式：POST
>
> 接口描述：创建班级
>
> 说明：仅在课程中的老师可以创建班级

**请求样例**

没有 id 的班级类型 `class`

| 参数说明  | 说明              | 类型   | 是否必须 | 备注 |
| --------- | ----------------- | ------ | -------- | ---- |
| course_id | 班级所属课程名 id | int    | 是       |      |
| name      | 班级名            | string | 是       |      |

**响应样例**

返回完整的 `class` 类型

### 查看所有老师

> 请求路径：`/teacher/allteacher`
>
> 请求方式：GET
>
> 接口描述：查看课程所有老师
>
> 说明：仅有老师可以进行搜索

**请求样例**

无

**响应样例**

老师列表 `List<User>`

### 查看课程所有老师

> 请求路径：`/teacher/all`
>
> 请求方式：GET
>
> 接口描述：查看课程所有老师
>
> 说明：仅有老师可以进行搜索

**请求样例**

| 参数说明  | 说明    | 类型 | 是否必须 | 备注 |
| --------- | ------- | ---- | -------- | ---- |
| course_id | 课程 id | int  | 是       |      |

**响应样例**

老师列表 `List<User>`

### 查看特定老师

> 请求路径：`/teacher/exact`
>
> 请求方式：GET
>
> 接口描述：查看特定老师
>
> 说明：仅有老师可通过学工号/姓名查看

**请求样例**

后端使用 `map` 类型获取

| 参数说明 | 说明        | 类型   | 是否必须 | 备注   |
| -------- | ----------- | ------ | -------- | ------ |
| username | 学工号/账号 | string | 否       | 多选一 |
| mail     | 邮箱        | string | 否       | 多选一 |
| name     | 姓名        | string | 否       | 多选一 |

**响应样例**

返回符合要求的老师列表 `List<User>`

### 查看课程所有学生

> 请求路径：`/stu/all`
>
> 请求方式：GET
>
> 接口描述：查看课程所有学生
>
> 说明：仅有老师/助教可以进行搜索

**请求样例**

方法同 **查看所有老师**

**响应样例**

方法同 **查看所有老师**

### 查看特定学生

> 请求路径：`/stu/exact`
>
> 请求方式：GET
>
> 接口描述：查看课程特定学生
>
> 说明：仅有老师/助教可以进行搜索

**请求样例**

方法同**查看特定老师**

**响应样例**

方法同**查看特定老师**

### 查看所有学生

> 请求路径：`/stu/allStu`
>
> 请求方式：GET
>
> 接口描述：查看系统所有学生
>
> 说明：仅有老师/助教可以进行搜索

**请求样例**

无

**响应样例**

列表 `List<User>`

### 课程邀请老师/助教

**基本信息**

> 请求路径：`/course/addAdmin`
>
> 请求方式：POST
>
> 接口描述：添加老师/助教
>
> 说明：仅课程内的老师可以执行

**请求样例**

| 参数说明  | 说明        | 类型   | 是否必须 | 备注                            |
| --------- | ----------- | ------ | -------- | ------------------------------- |
| username  | 学工号/账号 | string | 是       | 前端搜索到老师/助教之后进行邀请 |
| course_id | 课程 id     | int    | 是       | 用于讲目标对象邀请到哪门课程    |

**响应样例**

返回课程内所有老师/助教的列表 `List<User>`

### 班级添加老师/助教

**基本信息**

> 请求路径：`class/addAdmin`
>
> 请求方式：POST
>
> 接口描述：添加老师/助教
>
> 说明：仅有该班级的老师可以添加

**请求样例**

| 参数说明  | 说明        | 类型 | 是否必须 | 备注 |
| --------- | ----------- | ---- | -------- | ---- |
| class_id  | 班级 id     | int  | 是       |      |
| user_id   | 被添加人 id | int  | 是       |      |
| course_id | 课程 id     | int  | 是       |      |

**响应样例**

返回班级助教/老师列表 `List<User>`

### 查看班级内老师/助教

**基本信息**

> 请求路径：`class/admins`
>
> 请求方式：GET
>
> 接口描述：获取班级内的老师/助教
>
> 说明：所有人可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| class_id | 课程 | int  | 是       |      |

**响应样例**

返回列表 `List<User>`

### 查看课程内老师/助教

**基本信息**

> 请求路径：`course/admins`
>
> 请求方式：GET
>
> 接口描述：获取课程内的老师/助教
>
> 说明：所有人可以查看

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注 |
| --------- | ---- | ---- | -------- | ---- |
| course_id | 课程 | int  | 是       |      |

**响应样例**

返回列表 `List<User>`

### 用户查看所在课程内班级

**基本信息**

> 请求路径：`course/userClass`
>
> 请求方式：GET
>
> 接口描述：获取用户所在课程的所有班级
>
> 说明：所有人可以查看，不同身份拥有不同的查询结果数量

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注 |
| --------- | ---- | ---- | -------- | ---- |
| course_id | 课程 | int  | 是       |      |
| user_id   | 用户 | int  | 是       |      |

**响应样例**

- 对于助教/老师来说，返回该课程的所有班级
- 对于学生来说，返回学生所在课程内的班级

返回列表 `List<Class>`

### 导入学生名单

**基本信息**

> 请求路径：`/class/addFile`
>
> 请求方式：POST
>
> 接口描述：通过 csv/xlsx/xls 文件为班级添加学生
>
> 说明：老师可以通过文件为自己的某个班级导入学生，导入时查看学生是否已在，已在则跳过

**请求样例**

| 参数说明 | 说明         | 类型 | 是否必须 | 备注                                   |
| -------- | ------------ | ---- | -------- | -------------------------------------- |
| filename | 学生信息文件 | file | 是       | 可以为 csv/xlsx/xls 但需要后端检查格式 |
| user_id  | 操作人       | int  | 是       |                                        |
| class_id | 导入班级     | int  | 是       |                                        |



**响应样例**

格式符合要求且成功存储返回学生列表 `List<User>`

### 查看所有班级

> 请求路径：`/class/all`
>
> 请求方式：GET
>
> 接口描述：查看系统中的所有班级
>
> 说明：所有用户都可以查询

**请求样例**

无

**响应样例**

返回班级列表 `List<Course>`

### 查看所有班级分页

> 请求路径：`/class/all/page`
>
> 请求方式：GET
>
> 接口描述：查看系统中的所有班级
>
> 说明：所有用户都可以查询

**请求样例**

| 参数说明 | 说明     | 类型 | 是否必须 | 备注 |
| -------- | -------- | ---- | -------- | ---- |
| page     | 页码     | int  | 是       |      |
| size     | 页面大小 | int  | 是       |      |

**响应样例**

返回班级列表 `PageInfo<Class>`

```json
{
  "list": [
    { "id": 1, "name": "张三", "email": "zhangsan@example.com" },
    { "id": 2, "name": "李四", "email": "lisi@example.com" }
  ],
  "pageNum": 1,
  "pageSize": 10,
  "total": 100,
  "pages": 10
}
```



### 通过班级代码加入班级

**基本信息**

> 请求路径：`/class/apply`
>
> 请求方式：POST
>
> 接口描述：学生通过填写班级代码加入班级
>
> 说明：仅有学生可以进行操作

**请求样例**

| 参数说明   | 说明 | 类型   | 是否必须 | 备注 |
| ---------- | ---- | ------ | -------- | ---- |
| course_id  | 课程 | int    | 是       |      |
| class_code | 班级 | string | 是       |      |
| user_id    | 学生 | int    | 是       |      |

**响应样例**

返回状态码

### 查看课程信息

> 请求路径：`/course/info`
>
> 请求方式：GET
>
> 接口描述：查看课程信息
>
> 说明：所有人可以查询

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注 |
| --------- | ---- | ---- | -------- | ---- |
| course_id | 课程 | int  | 是       |      |

**响应样例**

返回课程信息 `Course`

### 查看课程所有班级

> 请求路径：`/course/classes`
>
> 请求方式：POST
>
> 接口描述：查看该课程的所有班级
>
> 说明：仅有该课程的老师/助教可以查询

**请求样例**

| 参数说明  | 说明   | 类型 | 是否必须 | 备注                  |
| --------- | ------ | ---- | -------- | --------------------- |
| course_id | 课程   | int  | 是       |                       |
| user_id   | 查询人 | int  | 是       | 需要是课程的老师/助教 |

**响应样例**

返回班级列表 `List<Class>`

### 查看班级学生

> 请求路径：`/class/stu`
>
> 请求方式：GET
>
> 接口描述：查看班级所有学生
>
> 说明：仅有老师/助教可以进行搜索

**请求样例**

| 参数说明  | 说明   | 类型 | 是否必须 | 备注                  |
| --------- | ------ | ---- | -------- | --------------------- |
| course_id | 课程   | int  | 是       |                       |
| class_id  | 班级   | int  | 是       |                       |
| user_id   | 查询人 | int  | 是       | 需要是课程的老师/助教 |

**响应样例**

返回学生列表 `List<User>`

### 添加班级学生

> 请求路径：`/class/addStu`
>
> 请求方式：POST
>
> 接口描述：添加学生
>
> 说明：老师/助教通过学生ID添加学生到班级

**请求样例**

| 参数说明  | 说明           | 类型   | 是否必须 | 备注           |
| --------- | -------------- | ------ | -------- | -------------- |
| course_id | 课程           | int    | 是       |                |
| class_id  | 班级           | int    | 是       |                |
| user_id   | 受理人         | int    | 是       |                |
| username  | 被邀请人学工号 | string | 是       | 作为学生被添加 |

**响应样例**

返回班级学生列表 `List<User>`

### 删除班级学生

> 请求路径：`/class/delStu`
>
> 请求方式：POST
>
> 接口描述：删除学生
>
> 说明：仅有老师/助教可以删除学生

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注                     |
| --------- | ---- | ---- | -------- | ------------------------ |
| course_id | 课程 | int  | 是       |                          |
| class_id  | 班级 | int  | 是       |                          |
| user_id   | 学生 | int  | 是       | 检查是否 identity 为学生 |

**响应样例**

返回学生列表 `List<User>`

### 查询自己课程

> 请求路径：`/course/self`
>
> 请求方式：POST
>
> 接口描述：查看自己所加入的课程
>
> 说明：所有人可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注                                                   |
| -------- | ---- | ---- | -------- | ------------------------------------------------------ |
| user_id  | 用户 | int  | 是       | 可以是任何人，学生来说分学生身份课程和助教身份课程返回 |

**响应样例**

返回课程列表，对于有助教身份的学生来说，返回两个列表 `List<List<Course>>`，`List[0]` 代表作为学生的，`List[1]` 代表作为助教的

### 学生查看所在班级

> 请求路径： `/class/studentin`
>
> 请求方式: GET
>
> 接口描述：查看所有加入的班级
>
> 说明：学生查看所有加入的班级

**请求样例**

| 参数说明 | 说明   | 类型 | 是否必须 | 备注 |
| -------- | ------ | ---- | -------- | ---- |
| user_id  | 用户id | int  | 是       |      |

**响应样例**

返回班级列表 `List<Class>`

## 模块三【10 ==杨佳宇轩==】

### 创建进度

> 请求路径：`/process/create`
>
> 请求方式：POST
>
> 接口描述：创建进度
>
> 说明：仅有老师可以在班级内添加进度

**请求样例**

不包含 `id` 的 `Process` 类

| 参数说明  | 说明     | 类型   | 是否必须 | 备注                          |
| --------- | -------- | ------ | -------- | ----------------------------- |
| name      | 进度名称 | string | 是       | 如, 第八周周一 / 第二章第三节 |
| course_id | 课程     | int    | 是       |                               |
| class_id  | 班级     | int    | 是       | 进度和班级多对一              |
| time      | 时间     | date   | 是       | 精确到年月日即可              |

**响应样例**

返回完整的 `Process` 类, 包含 `id`

### 查看班级进度

> 请求路径：`/process/get`
>
> 请求方式：GET
>
> 接口描述：查看班级所有进度
>
> 说明：所有人可以查询

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注 |
| --------- | ---- | ---- | -------- | ---- |
| course_id | 课程 | int  | 是       |      |
| class_id  | 班级 | int  | 是       |      |

**响应样例**

返回进度列表 `List<Process>`

### 下载资源

> 请求路径：`/process/resource/get`
>
> 请求方式：GET
>
> 接口描述：通过资源 `res_id` 查询下载
>
> 说明：所有人可以下载，同时这也就包含了历史资源的下载

**请求样例**

| 参数说明 | 说明     | 类型 | 是否必须 | 备注 |
| :------: | -------- | ---- | -------- | ---- |
|  res_id  | 资源编号 | int  | 是       |      |

**响应样例**

返回资源在阿里云中存储的 `url` 即返回 `String`

### 通过[进度]查看所有资源

> 请求路径：`/process/resource/all`
>
> 请求方式：GET
>
> 接口描述：查看进度的所有资源
>
> 说明：所有人可以查看，对于查看公共资源，将 `process_id` 设置为 `-1` 即可

**请求样例**

| 参数说明   | 说明 | 类型 | 是否必须 | 备注 |
| ---------- | ---- | ---- | -------- | ---- |
| course_id  | 班级 | int  | 是       |      |
| process_id | 进度 | int  | 是       |      |

**响应样例**

返回资源列表, `List<Resource>`

### 通过标签查找可访问的所有资源

> 请求路径：`/process/resource/tag`
>
> 请求方式：GET
>
> 接口描述：查看可以访问的该课程的所有资源
>
> 说明：所有人可以查看，需要通过身份 + 班级进行访问，并结合公共资源进行查询，并进行去重操作

**请求样例**

| 参数说明  | 说明     | 类型        | 是否必须 | 备注                                                         |
| --------- | -------- | ----------- | -------- | ------------------------------------------------------------ |
| course_id | 课程     | int         | 是       | 用于指定查询范围                                             |
| user_id   | 用户     | int         | 是       | 用于确定查询者身份, 老师/助教可查询所有, 学生只可以查询自己班级 |
| tags      | 标签列表 | list\<tag\> | 是       | 可以为空列表,但不能为 null,为空时不进行tag匹配,返回符合要求的所有 |

**响应样例**

资源列表 `List<Resource>`, 后端需要对于符合要求 tag 的所有资源进行去重处理, 具体为通过对所有相同的 `res_code` 进行排序,选出 `date` 最新的作为返回

另外,去重也包括对于公共资源和自己班级有的资源都一起进行排序,来取最新, 这俩步可以合并为一个列表之后快速进行

### 查询所有标签

> 请求路径：`/tag/all`
>
> 请求方式：POST
>
> 接口描述：查看所有标签
>
> 说明：所有人可以查看

**请求样例**

无

**响应样例**

标签列表 `List<Tag>`

### 上传资源

> 请求路径：`/process/resource/add`
>
> 请求方式：POST
>
> 接口描述：上传对应进度的资源
>
> 说明：仅有老师/助教可以上传；由阿里云SSO服务，最大资源上传为 **1MB**

**请求样例**

| 参数说明   | 说明     | 类型        | 是否必须 | 备注                               |
| ---------- | -------- | ----------- | -------- | ---------------------------------- |
| course_id  | 课程     | int         | 是       |                                    |
| class_id   | 班级     | int         | 是       |                                    |
| process_id | 进度     | int         | 是       |                                    |
| data       | 数据     | file        | 是       | 后端获得之后转化为数据库 blob 数据 |
| tags       | 标签列表 | list\<int\> | 是       | 但可以为空列表                     |
| is_public  | 是否公开 | boolean     | 是       | 是否为课程公共资源                 |

**响应样例**

返回 `url`, 如果为公共资源, 则复制一份, 将 `process_id` 设置为 `-1` 表示公共区域资源

### 删除资源

> 请求路径：`/process/resource/delete`
>
> 请求方式：POST
>
> 接口描述：删除对应进度的资源
>
> 说明：仅有老师/助教可以进行删除

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注                  |
| -------- | ---- | ---- | -------- | --------------------- |
| res_id   | 资源 | int  | 是       |                       |

**响应样例**

返回状态码

对于删除资源, 后端查询该 `res_id` 对应的 `res_code`, 将所有的历史版本都删除, 即所有与其有相同 `res_code` 的资源行都删除

### 更新资源

> 请求路径：`/process/resource/update`
>
> 请求方式：POST
>
> 接口描述：重新上传某个资源
>
> 说明：仅有老师/助教可以重新上传，上传后更新历史数据

**请求样例**

| 参数说明  | 说明     | 类型    | 是否必须 | 备注                         |
| --------- | -------- | ------- | -------- | ---------------------------- |
| res_id    | 原资源   | int     | 是       |                              |
| data      | 文件     | file    | 是       | 必须保持和原来的资源类型相同 |
| is_public | 是否公共 | boolean | 是       |                              |

**响应样例**

返回新的资源类 `Resource`

该资源的其他信息和原资源保持一致, 特别是 `res_code` 保持一致,表示相同的资源的不同版本, `name | date` 可以更新, `res_id` 自动生成新的主键

后端需检查前后历史资源的 `type` 是否相同,不同则一定返回错误状态码

### 查看资源历史记录

> 请求路径：`/process/resource/history`
>
> 请求方式：GET
>
> 接口描述：查看资源的历史版本记录
>
> 说明：所有人可以查看，一定需要返回资源的 `res_id`

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| res_id   | 资源 | int  | 是       |      |

**响应样例**

通过查询其 `res_code` ,进而查询所有的历史版本，获取的版本里边不包含公共的（因为公共的一定也是私有的）, 按时间顺序排序并返回 `List<Resource>`

## 模块四【4 ==唐皓涵==】

### 查看对应题目

> 请求路径：`/problem/info`
>
> 请求方式：GET
>
> 接口描述：查看对应id题目
>
> 说明：无

**请求样例**

| 参数说明 | 说明   | 类型    | 是否必须 | 备注 |
| -------- | ------ | ------- | -------- | ---- |
| id       | 题目id | Integer | 是       |      |

**响应样例**

返回一个完成题目`Problem`

### 创建题目

> 请求路径：`/problem/add`
>
> 请求方式：POST
>
> 接口描述：创建新题目
>
> 说明：老师/助教可以创建

**请求样例**

| 参数说明    | 说明     | 类型    | 是否必须 | 备注                                     |
| ----------- | -------- | ------- | -------- | ---------------------------------------- |
| type        | 题目类型 | string  | 是       | 选/填/简答/编程                          |
| is_public   | 是否公开 | boolean | 是       | 是否加入题目题库                         |
| creator_id  | 创建者   | int     | 是       | 老师/助教                                |
| description | 题目描述 | string  | 是       |                                          |
| str_content     | 题目选项 | json    | 否       | 对于选择题需要加入一个json类型的选项映射 |
| answer      | 答案     | string  | 是       |                                          |
| analysis    | 解析     | string  | 否       |                                          |

**响应样例**

返回题目类型的完整类 `Problem`

### 查看公有题目

> 请求路径：`/problem/public`
>
> 请求方式：GET
>
> 接口描述：通过指定的 type 来筛选公有题目
>
> 说明：所有人可以查看，如果 type 为 null 则返回所有

**请求样例**

| 参数说明 | 说明         | 类型         | 是否必须 | 备注         |
| -------- | ------------ | ------------ | -------- | ------------ |
| types    | 题目类型列表 | list\<type\> | 是       | 可以为空列表 |

**响应样例**

返回题目列表 `List<Problem>`,随机排列即可

### 查看自己创建的题目

> 请求路径：`/problem/self`
>
> 请求方式：GET
>
> 接口描述：通过指定的 type 来筛选自己创建的题目
>
> 说明：所有人可以查看，如果 type 为 null 则返回所有

**请求样例**

| 参数说明 | 说明     | 类型         | 是否必须 | 备注         |
| -------- | -------- | ------------ | -------- | ------------ |
| user_id  | 用户     | int          | 是       |              |
| types    | 类型列表 | list\<type\> | 是       | 可以为空列表 |

**响应样例**

返回题目列表 `List<Problem>`,随机排列即可

## 模块五【13 ==庄耿雄==】

### 创建任务

> 请求路径：`/exer/create`
>
> 请求方式：POST
>
> 接口描述：创建任务
>
> 说明：老师/助教可以操作，在创建了任务之后，将题目任务分数内容插入到 `t_stu_prob_exer` 表中

**请求样例**

| 参数说明   | 说明             | 类型        | 是否必须 | 备注                                               |
| ---------- | ---------------- | ----------- | -------- | -------------------------------------------------- |
| course_id  | 课程             | int         | 是       | 课程id                                             |
| creator_id | 创建者           | int         | 是       | 后端需要检查是否为老师/助教                        |
| begin_time | 开始时间         | date        | 是       | 精确到时分秒                                       |
| end_time   | 截止时间         | date        | 是       | 精确到时分秒                                       |
| is_public  | 是否公开         | boolean     | 是       | 是否作为公共模板库                                 |
| name       | 任务名           | string      | 是       |                                                    |
| is_multi   | 是否允许多次提交 | boolean     | 是       | 学生是否可以提交之后再次做作业                     |
| probs      | 题目列表         | list\<int\> | 是       | 不可以为空列表, 用于总分计算和加入学生-题目-任务表 |
| scores     | 分数列表         | list\<int\> | 是       | 每道题对应的分数, 下标对应                         |

**响应样例**

- 任务总分 `score` 后端进行计算, 由题目总分进行加和

	返回完整的任务类 `Exercise`

- 将题目和任务的对应关系插入到 学生-题目-任务表 中, 设置 `stu_id = -1` 表示标准满分, 并填入题号等信息

### 发布任务

> 请求路径：`/exer/push`
>
> 请求方式：POST
>
> 接口描述：为班级发布新任务
>
> 说明：老师/助教可发布，发布时本质是复制一份。更新 `t_stu_prob_exer` 表，更新学生和任务的关系信息以及学生和题目的所有信息，方便查询

**请求样例**

| 参数说明       | 说明               | 类型    | 是否必须 | 备注                                           |
| -------------- | ------------------ | ------- | -------- | ---------------------------------------------- |
| exer_id        | 任务模板           | int     | 是       |                                                |
| course_id      | 课程               | int     | 是       |                                                |
| class_id       | 发布到的班级       | int     | 是       |                                                |
| creator_id     | 创建者             | int     | 是       |                                                |
| begin_time     | 开始时间           | date    | 是       | 参照上文                                       |
| end_time       | 截止时间           | date    | 是       | 参照上文                                       |
| is_multi       | 是否允许多次提交   | boolean | 是       | 参照上文                                       |
| name           | 作业名             | string  | 是       |                                                |
| is_every_class | 是否发布到所有班级 | boolean | 是       | 如果发布到所有班级,则循环班级,执行相同操作即可 |

**响应样例**

返回状态码

默认不公开, 仅存在于数据库中

对于该班级的所有学生,将任务和学生的交互信息以及题目和学生的交互信息全部插入到 学生-题目-任务 表中, 用于打分/评语, 检查是否已经批改学生作业

### 查询任务信息

> 请求路径：`/exer/info`
>
> 请求方式：POST
>
> 接口描述：查看任务的信息
>
> 说明：所有人可以查看, 可以用于查看该任务是否允许多次提交

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 任务 | int  | 是       |      |

**响应样例**

返回任务类型 `Exercise`

### 查询任务题目

> 请求路径：`/exer/get`
>
> 请求方式：GET
>
> 接口描述：查看任务的所有题目
>
> 说明：所有人可以查看. 另外, 结合创建任务API, 可以实现从现有公开任务模板库中创建新的模板

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 任务 | int  | 是       |      |

**响应样例**

按照判断-选择-填空-简答-编程的顺序返回排好序的 `List<Problem>` 列表

### 通过班级(课程)查看任务

> 请求路径：`/exer/class/get`
>
> 请求方式：GET
>
> 接口描述：查看班级内的所有任务
>
> 说明：所有人可以查看任务

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注 |
| --------- | ---- | ---- | -------- | ---- |
| course_id | 课程 | int  | 是       |      |
| class_id  | 班级 | int  | 是       |      |

**响应样例**

任务列表 `List<Exercise>`

### 学生查询所有自己的任务

> 请求路径：`/exer/allSelf`
>
> 请求方式：GET
>
> 接口描述：查看所有学生的任务（所有课程内的）
>
> 说明：学生可查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| user_id  | 学生 | int  | 是       |      |

**响应样例**

返回任务列表 `List<Exercise>`

### 学生查询所有自己已做完的任务

> 请求路径：`/exer/alldone`
>
> 请求方式：GET
>
> 接口描述：查看所有学生已做完的任务（所有课程内的）
>
> 说明：学生可查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| user_id  | 学生 | int  | 是       |      |

**响应样例**

返回任务列表 `List<Exercise>`

### 学生查询所有待做

> 请求路径：`/exer/allTodo`
>
> 请求方式：GET
>
> 接口描述：查看所有学生未做完的任务（所有课程内的）
>
> 说明：学生可查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| user_id  | 学生 | int  | 是       |      |

**响应样例**

返回任务列表 `List<Exercise>`

### 查看公有任务

> 请求路径：`/exer/public`
>
> 请求方式：GET
>
> 接口描述：查看所有公有的任务
>
> 说明：老师/助教可查看

**请求样例**

| 参数说明  | 说明   | 类型 | 是否必须 | 备注 |
| --------- | ------ | ---- | -------- | ---- |
| course_id | 课程id | int  | 是       |      |

**响应样例**

返回任务表中公开的任务, 返回任务列表 `List<Exercise>`

### 查看自己创建的任务

> 请求路径：`/exer/self`
>
> 请求方式：POST
>
> 接口描述：查看自己创建的所有任务
>
> 说明：老师/助教可以查看，查看的是作为模板的任务 class_id = -1

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注      |
| -------- | ---- | ---- | -------- | --------- |
| user_id  | 用户 | int  | 是       | 老师/助教 |

**响应样例**

查询数据库中是模板且是该用户创建的任务, 返回任务列表 `List<Exercise>`

### 提交任务

> 请求路径：`/exer/submit`
>
> 请求方式：POST
>
> 接口描述：学生完成任务后提交任务
>
> 说明：学生可操作，必须所有题目都完成才可以提交

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 任务 | int  | 是       |      |
| user_id  | 用户 | int  | 是       |      |

**响应样例**

返回状态码

更新数据库, 将学生对于该任务的信息 `is_finish` 置一

### 查看学生任务完成人数

> 请求路径：`/exer/all/finish`
>
> 请求方式：GET
>
> 接口描述：查看某任务的完成数目
>
> 说明：老师/助教可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 任务 | int  | 是       |      |

**响应样例**

查询学生-题目-任务表中该任务所有已提交的数目, 返回 `Integer`

### 学生查询班级已完成任务

> 请求路径：`/exer/stu/finish`
>
> 请求方式：POST
>
> 接口描述：查询学生对于该班级的任务的完成数量
>
> 说明：学生可以操作

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注 |
| --------- | ---- | ---- | -------- | ---- |
| user_id   | 学生 | int  | 是       |      |
| course_id | 课程 | int  | 是       |      |
| class_id  | 班级 | int  | 是       |      |

**响应样例**

返回两个数字,分别是"完成数目 / 总任务数" `List<Integer>`, 列表长度为 2

## 模块六【9 ==杨佳宇轩==】

### 查询未批改任务

> 请求路径：`/check/todo`
>
> 请求方式：GET
>
> 接口描述：查询未批改的任务
>
> 说明：老师/助教可以查看

**请求样例**

| 参数说明  | 说明 | 类型 | 是否必须 | 备注               |
| --------- | ---- | ---- | -------- | ------------------ |
| user_id   | 用户 | int  | 是       | 老师/助教          |
| course_id | 课程 | int  | 否       | 如果为-1则代表所有 |

**响应样例**

仅对于超越了截止时间的作业可以批改, 否则返回错误状态码

- 若没有 course_id, 则先查询老师参与的所有课程
- 对于所有的 course_id, 查询到老师执教的所有班级
- 通过班级查询所有的任务
- 对于每一项任务, 获取该项任务中是否存在提交的学生, 但 `is_check` 为 0 的任务

返回 `List<Exercise>`

### 查询未批改任务的未批改学生

> 请求路径：`/check/stu`
>
> 请求方式：GET
>
> 接口描述：通过任务查询未批改的学生
>
> 说明：老师/助教可以操作

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 任务 | int  | 是       |      |

**响应样例**

查询该项任务中所有学生 `is_check` 为 0 的学生 id, `List<User>`

### 批改任务提交

> 请求路径：`/check/push`
>
> 请求方式：POST，`form-data`
>
> 接口描述：批改任务的提交
>
> 说明：老师/助教可以操作，且必须批改完才可以提交（后端检查），前端发送的分数和评语列表长度需相同

**请求样例**

| 参数说明 | 说明     | 类型           | 是否必须 | 备注 |
| -------- | -------- | -------------- | -------- | ---- |
| user_id  | 学生     | int            | 是       |      |
| exer_id  | 任务     | int            | 是       |      |
| scores   | 得分列表 | list\<int\>    | 是       |      |
| infos    | 评语列表 | list\<string\> | 是       |      |

<img src="C:\Users\12298\AppData\Roaming\Typora\typora-user-images\image-20250504112607839.png" alt="image-20250504112607839" style="zoom:50%;" />

**响应样例**

返回状态码

后端需要检查是否得分列表长度和评语列表长度等于任务题目数, 否则返回错误状态码

若成功,则需要修改学生-题目-任务表中的学生对于该项任务中的每道题的交互数据以及学生和任务的交互数据,包括 `score` 总分以及 `is_check` 等

注: 若前端支持, 对于已经批改过的, 如果需要重新提交, 后端需要进行覆盖操作

### 查询批改信息

> 请求路径：`/check/get`
>
> 请求方式：GET
>
> 接口描述：查询某一项任务的批改信息
>
> 说明：所有人可以查看; 可用于"自动批改"功能, 在任务批改开始之前获取一次批改信息

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 练习 | int  | 是       |      |
| user_id  | 学生 | int  | 是       |      |

**响应样例**

返回题目列表、得分列表、反馈信息列表，是否批改列表、学生答案列表，`[List<Problem>, List<Integer>, List<String>, List<Boolean>, List<String>, List<Integer>]`

后端需要对于选填题进行**自动化批阅**, 并更新得分列表

### 查询任务的所有学生成绩/排名

> 请求路径：`/check/result`
>
> 请求方式：GET
>
> 接口描述：查看任务的所有学生的成绩与排名
>
> 说明：老师/助教可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 练习 | int  | 是       |      |

**响应样例**

后端获取任务对应的所有学生的提交信息, 对于未批改 `is_check = 0` 则标注成绩为 `-1`

对于学生以及其成绩,进行排序, 返回两个列表 `[List<User>, List<Integer>]`

### 查询练习中所有题目通过比例以及平均分

> 请求路径：`/check/access`
>
> 请求方式：GET
>
> 接口描述：查看任务中所有题目的通过比例以及平均分
>
> 说明：老师/助教可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 练习 | int  | 是       |      |

**响应样例**

对于没有批改过的题目，其比例和平均分为 `-1`

对于题目以及通过比例进行排序, 返回两个列表 `[List<Problem>, List<Float>, List<Float>]`

### 生成并下载任务反馈报告

> 请求路径：`/exer/adminReport`
>
> 请求方式：GET
>
> 接口描述：生成并下载该任务的所有学生做题反馈报告
>
> 说明：老师/助教可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| exer_id  | 任务 | int  | 是       |      |

**响应样例**

后端基于数据库设计并生成反馈报告

返回文件下载 `url`

### 查询历史练习分数/排名

> 请求路径：`check/history`
>
> 请求方式：GET
>
> 接口描述：生成练习报告时学生查询自己所有的历史学习成绩曲线
>
> 说明：学生操作

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| user_id  | 学生 | int  | 是       |      |

**响应样例**

对于没有批改的练习，不进行返回

返回三个个列表 `List<List<Exercise>, List<Integer>, List<Integer>>` 练习 - 排名 - 成绩

### 导出练习报告

> 请求路径：`/exer/stuReport`
>
> 请求方式：GET
>
> 接口描述：生成并下载学生对于该任务的做题报告
>
> 说明：学生可以操作

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| user_id  | 学生 | int  | 是       |      |

**响应样例**

后端基于数据库设计并生成练习报告

返回 url

## 模块七【5 ==杨佳宇轩==】

### 收藏题目

> 请求路径：`/collect/addLike`
>
> 请求方式：POST
>
> 接口描述：收藏题目
>
> 说明：所有人可以操作

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| prob_id  | 题目 | int  | 是       |      |
| stu_id   | 用户 | int  | 是       |      |

**响应样例**

返回状态码

### 添加错题

> 请求路径：`/collect/addWrong`
>
> 请求方式：POST
>
> 接口描述：添加错题
>
> 说明：学生可操作

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| prob_id  | 题目 | int  | 是       |      |
| exer_id  | 练习 | int  | 是       |      |
| stu_id   | 学生 | int  | 是       |      |

**响应样例**

建议前端先进行"提交批改信息"接口, 再紧接调用该接口进行错题添加

后端查看所有的该学生和该练习的交互, 并自动进行数据库的更新

返回状态码

### 删除收藏

> 请求路径：`/collect/deleteLike`
>
> 请求方式：DELETE
>
> 接口描述：删除收藏的题目
>
> 说明：所有人可以操作

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| prob_id  | 题目 | int  | 是       |      |
| stu_id   | 用户 | int  | 是       |      |

**响应样例**

返回状态码

### 查看错题

> 请求路径：`/collect/getWrong`
>
> 请求方式：GET
>
> 接口描述：查看同学的所有错题
>
> 说明：学生可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| stu_id   | 学生 | int  | 是       |      |

**响应样例**

返回错题列表 `List<List<Problem>, List<Exercise>>` 分别是题目的列表和题目所属练习的列表

### 查看收藏

> 请求路径：`/collect/getLike`
>
> 请求方式：GET
>
> 接口描述：查看收藏的所有题目
>
> 说明：所有人可以查看

**请求样例**

| 参数说明 | 说明 | 类型 | 是否必须 | 备注 |
| -------- | ---- | ---- | -------- | ---- |
| stu_id   | 用户 | int  | 是       |      |

**响应样例**

返回收藏题目列表 `List<Problem>`
